coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70)) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black")) +
scale_y_continuous(limits=c(-1,20), breaks=0:20) +
labs(fill="Disease Stage", colour="", shape="",
x="Subject Recevied Study Drug") +
theme_bw()
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.7) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70)) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black")) +
scale_y_continuous(limits=c(-1,20), breaks=0:20) +
labs(fill="Disease Stage", colour="", shape="",
x="Subject Recevied Study Drug") +
theme_bw() +
theme(panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
sT
dat
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.7)
set.seed(33)
dat = data.frame(Subject = 1:10,
Months = sample(4:20, 10, replace=TRUE),
Treated=sample(0:1, 10, replace=TRUE),
Stage = sample(1:4, 10, replace=TRUE),
Continued=sample(0:1, 10, replace=TRUE))
dat = dat %>%
group_by(Subject) %>%
mutate(Complete=sample(c(4:(max(Months)-1),NA), 1,
prob=c(rep(1, length(4:(max(Months)-1))),5), replace=TRUE),
Partial=sample(c(4:(max(Months)-1),NA), 1,
prob=c(rep(1, length(4:(max(Months)-1))),5), replace=TRUE),
Durable=sample(c(-0.5,NA), 1, replace=TRUE))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.7)
str(dat)
dat$Subject = factor(dat$Subject)
dat = data.frame(Subject = 1:10,
Months = sample(4:20, 10, replace=TRUE),
Treated=sample(0:1, 10, replace=TRUE),
Stage = sample(1:4, 10, replace=TRUE),
Continued=sample(0:1, 10, replace=TRUE))
dat = dat %>%
group_by(Subject) %>%
mutate(Complete=sample(c(4:(max(Months)-1),NA), 1,
prob=c(rep(1, length(4:(max(Months)-1))),5), replace=TRUE),
Partial=sample(c(4:(max(Months)-1),NA), 1,
prob=c(rep(1, length(4:(max(Months)-1))),5), replace=TRUE),
Durable=sample(c(-0.5,NA), 1, replace=TRUE))
dat$Subject = factor(dat$Subject)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.7)
dat
dat$Subject = factor(dat$Subject, levels=dat$Subject[order(dat$Months)])
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.7)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.5)
dat.m
+
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.5) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4)
dat
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.5) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in")))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.5) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3)
hcl(seq(15,375,length.out=5)
)
a <- seq(15, 375, length.out = 5)
a
?hcl
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70)) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100),"black", "black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100),"red", "black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100, 100),"red", "black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100, 100),"black", "black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100, 40),"black", "black"))
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70)) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black")) +
scale_y_continuous(limits=c(-1,20), breaks=0:20)
dat
dat.m
dat = data.frame(Subject = 1:10,
Months = sample(4:20, 10, replace=TRUE),
Treated=sample(0:1, 10, replace=TRUE),
Stage = sample(1:4, 10, replace=TRUE),
Continued=sample(0:1, 10, replace=TRUE))
dat
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8)
ggplot(dat, aes(Subject, Months)) +
geom_bar(stat="identity", aes(fill=factor(Stage)), width=0.8) +
geom_point(data=dat.m,
aes(Subject, value, colour=variable, shape=variable), size=4) +
geom_segment(data=dat %>% filter(Continued==1),
aes(x=Subject, xend=Subject, y=Months + 0.1, yend=Months + 1),
pch=15, size=0.8, arrow=arrow(type="closed", length=unit(0.1,"in"))) +
coord_flip() +
geom_hline(yintercept=3) +
scale_fill_manual(values=hcl(seq(15,375,length.out=5)[1:4],100,70)) +
scale_colour_manual(values=c(hcl(seq(15,375,length.out=3)[1:2],100,40),"black")) +
scale_y_continuous(limits=c(-1,20), breaks=0:20) +
labs(fill="Disease Stage", colour="", shape="",
x="Subject Recevied Study Drug") +
theme_bw() +
theme(panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
q()
q()
library(data.table)
install.packages("jsonlite")
install.packages(c("dplyr", "purrr", "tidytext"))
install.packages(c("syuzhet", "DT", "randomForest"))
library(data.table)
install.packages(c("data.table", "tibble"))
install.packages(c("tidry", "lubridate"))
q()
92058.46+98458.09 + 11685.20
0.46 + 0.09 + 0.20
92058+98458+11685
202201.75 + 17.13
75+13
options(digits=2)
202201.75 + 17.13
options(digits=10)
202201.75 + 17.13
830.84 + 7257.23 + 6662.12
14750.19 + 5607.49
20357.68 + 5459.62 + 1800
202218.88 - 27617.3
4050*3
174601.58 - 12150
162451.58 * 0.28 - 13014.50
174601.58 + 27617.3
27617.30
27167.3 * 0.8
202218.88
202218.88 - 83800
202218.88 - 159700
42518.88 * 0.25
118418.88 + 10629.72
129048.6 * 0.26
174601.58 + 20357.68
194959.26 - 159700
35259.26 * 0.25
83800 - 8814.82
194959.26 - 74985.18
119974.08 * 0.26
2075*12
24900+375
11685.20 + 92058.46
202218.88 - 110000
93000 * 0.05
32471.94 - 600
407.99 + 10600.89 + 21258.46
32267.34 - 31871.94
202218.88 - 1800
27617.30 - 14750.19
200418.88 - 12867.11
37551.77 * 0.05
1877.5885 + 7072.50
187551.77 * 0.032
8950.09 + 6001.66
14951.75 - 14750.19
q()
q()
q()
q()
q()
q()
text <- c("Because I could not stop for Death -",
"He kindly stopped for me -",
"The Carriage held but just Ourselves -",
"and Immortality")
text
library(dplyr)
library(ggplot2)
text_df <- data_frame(line = 1:4, text = text)
library(tidytext)
text_df %>%
unnest_tokens(word, text)
test_df
text_df
library(janeaustenr)
#library(dplyr)
library(stringr)
?austen_books
a <- austen_books()
str(a)
a
head(a)
a[500:550,]
a <- austen_books() %>% group_by(book)
str(a)
a
?row_number()
?cumsum
?row_number()
?cumsum
a <- austen_books()
str(a)
b <- a[1:100, ]
b
b[50:55,]
g <- mutate(b, cha = str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))
g
?regex
g <- mutate(b, cha = str_detect(text, regex("^chapter [ivxlc]", ignore_case = TRUE)))
g
g <- mutate(b, cha = str_detect(text, regex("^chapter [\\d]", ignore_case = TRUE)))
g
g <- mutate(b, cha = cumsum(str_detect(text, regex("^chapter [\\d]", ignore_case = TRUE))))
g
g[1:20,]
?ungroup
original_books <- austen_books() %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",
ignore_case = TRUE)))) %>%
ungroup()
original_books
tidy_books <- original_books %>%
unnest_tokens(word, text)
str(tidy_books)
tidy_books
?anti_join
data("stop_words")
tidy_books <- tidy_books %>%
anti_join(stop_words)
tidy_books
?count
tidy_books %>%
count(word, sort = TRUE)
?reorder
tidy_books %>%
count(word, sort = TRUE) %>%
filter(n > 600) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(word, n)) +
geom_col() +
xlab(NULL) +
coord_flip()
q()
library(tidytext)
sentiments
get_sentiments("afinn")
get_sentiments("bing")
get_sentiments("nrc")
q()
library(h2o)
q()
q()
q()
x <- c(5,9.2,3,8.51,NA),
x <- c(5,9.2,3,8.51,NA)
mean(x)
mean(x, na.rm = TRUE)
x[0]
x[1]
q()
q()
library(data.table)
DT = data.table(a = c('x', 'y', 'x','z'), b = 1:4)
DT
library(Matrix)
DT = data.table(a = c('x', 'y', 'x','z'), b = 1:4, g = c('a', 'b','a', 'c'))
DT
sparse_matrix <- sparse.model.matrix(a ~ .-1, data = DT)
sparse_matrix
dummies <- dummyVars(~ a + g, data = DT)
?dummyVars
install.packages("xgboost")
q()
library(tm)
install.packages("tm")
library(SnowballC)
library(wordcloud)
reviews = read.csv("movie_reviews.csv", stringsAsFactors = F)
reviews = read.csv("movie_reviews.csv", stringsAsFactors = F)
getwd()
if (Sys.info()[1] == 'Windows'){
setwd('C:/Users/alin/Documents/SelfStudy/MyLearning/tidytext/')
}else{
setwd('/home/alin/MyLearning/tidytext/')
}
reviews = read.csv("movie_reviews.csv", stringsAsFactors = F)
reviews$content <- reviews$review
reviews$polarity <- as.factor(reviews$sentiment)
reviews$review <- NULL
reviews$sentiment <-NULL
review_corpus = Corpus(VectorSource(reviews$content))
library(tm)
review_corpus = Corpus(VectorSource(reviews$content))
str(review_corpus)
review_corpus = tm_map(review_corpus, content_transformer(tolower))
inspect(review_corpus[1])
review_corpus = tm_map(review_corpus, removeNumbers)
review_corpus = tm_map(review_corpus, removePunctuation)
inspect(review_corpus[1])
review_corpus = tm_map(review_corpus, removeWords, c("the", "and", stopwords("english")))
inspect(review_corpus[1])
review_corpus =  tm_map(review_corpus, stripWhitespace)
inspect(review_corpus[1])
review_dtm <- DocumentTermMatrix(review_corpus)
review_dtm <- DocumentTermMatrix(review_corpus)
review_dtm
inspect(review_dtm[500:505, 500:505])
review_dtm = removeSparseTerms(review_dtm, 0.95)
review_dtm
inspect(review_dtm[1,1:20])
findFreqTerms(review_dtm, 1000)
freq = data.frame(sort(colSums(as.matrix(review_dtm)), decreasing=TRUE))
ncol(freq)
nrow(freq)
freq[1:10,]
class(freq)
str(freq)
names(freq)
rownames(freq)
?findFreqTerms
findFreqTerms(review_dtm, 5000)
freq = data.frame(sort(colSums(as.matrix(review_dtm)), decreasing=TRUE))
dim(freq)
rownames(freq)
wordcloud(rownames(freq), freq[,1], max.words=50, colors=brewer.pal(1, "Dark2"))
review_dtm_tfidf <- DocumentTermMatrix(review_corpus, control = list(weighting = weightTfIdf))
review_dtm_tfidf = removeSparseTerms(review_dtm_tfidf, 0.95)
review_dtm_tfidf
inspect(review_dtm_tfidf[1,1:20])
freq = data.frame(sort(colSums(as.matrix(review_dtm_tfidf)), decreasing=TRUE))
wordcloud(rownames(freq), freq[,1], max.words=100, colors=brewer.pal(1, "Dark2"))
library(tm)
library(topicmodels)
data("AssociatedPress", package = "topicmodels")
install.packages("topicmodels")
library(topicmodels)
data("AssociatedPress", package = "topicmodels")
AssociatedPress
terms <- Terms(AssociatedPress)
head(terms)
library(dplyr)
library(tidytext)
ap_td <- tidy(AssociatedPress)
ap_td
ap_sentiments <- ap_td %>%
inner_join(get_sentiments("bing"), by = c(term = "word"))
ap_sentiments
library(ggplot2)
ap_sentiments %>%
count(sentiment, term, wt = count) %>%
ungroup() %>%
filter(n >= 200) %>%
mutate(n = ifelse(sentiment == "negative", -n, n)) %>%
mutate(term = reorder(term, n)) %>%
ggplot(aes(term, n, fill = sentiment)) +
geom_bar(stat = "identity") +
ylab("Contribution to sentiment") +
coord_flip()
ap_sentiments %>%
count(sentiment, term, wt = count)
q()
